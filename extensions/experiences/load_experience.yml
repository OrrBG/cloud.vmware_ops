---
- hosts: localhost
  gather_facts: false
  collections:   # noqa fqcn[keyword]   We have no control over this
    - awx.awx
  vars:
    controller_configuration_credentials_secure_logging: false
    controller_validate_certs: false
    controller_hostname: "{{ lookup('env', 'CONTROLLER_HOST') }}"
    controller_username: "{{ lookup('env', 'CONTROLLER_USERNAME') }}"
    controller_password: "{{ lookup('env', 'CONTROLLER_PASSWORD') }}"
    experience_name: vmware_ops

  tasks:
    - name: Include Setup YAML
      ansible.builtin.include_vars: "{{ playbook_dir }}/{{ experience_name }}/setup.yml"

    - name: Execute automation controller resource configuration
      ansible.builtin.include_role:
        name: infra.controller_configuration.dispatch
      vars:
        controller_configuration_async_delay: 1
        controller_configuration_async_retries: 30
